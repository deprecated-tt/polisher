# Screen Text Capture - Polisher

Python tray приложение для захвата и распознавания текста с экрана.

## Возможности

- Выбор произвольной области экрана
- Захват скриншота выбранной области
- Распознавание текста (OCR) на русском и английском языках
- Автоматическое копирование распознанного текста в буфер обмена
- Работа из системного трея

## Установка

### 1. Установите Tesseract OCR

#### Windows:
Скачайте и установите Tesseract с https://github.com/UB-Mannheim/tesseract/wiki

После установки добавьте путь к tesseract.exe в PATH или укажите в коде:
```python
pytesseract.pytesseract.tesseract_cmd = r'C:\Program Files\Tesseract-OCR\tesseract.exe'
```

#### Linux:
```bash
sudo apt-get install tesseract-ocr tesseract-ocr-rus tesseract-ocr-eng
```

### 2. Установите Python зависимости

```bash
pip install -r requirements.txt
```

## Использование

1. Запустите приложение:
```bash
python main.py
```

2. В системном трее появится иконка приложения

3. Нажмите правой кнопкой на иконку и выберите:
   - **Выбрать область** - выберите область экрана для захвата
   - **Захватить текст** - сделать скриншот и распознать текст
   - **Выход** - закрыть приложение

4. При выборе области:
   - Зажмите левую кнопку мыши и выделите нужную область
   - Отпустите кнопку мыши для сохранения выбора
   - Нажмите ESC для отмены

5. Распознанный текст автоматически копируется в буфер обмена

## Статистика и анализ

Приложение автоматически записывает статистику всех попыток прокачки предметов в файл `polisher_statistics.jsonl`.

### Анализ статистики

Для анализа собранной статистики запустите:

```bash
python analyze_statistics.py
```

Скрипт выведет:
- **Успешность по уровням**: процент успешных попыток для каждого уровня (+0 → +1, +1 → +2, и т.д.)
- **Статистику по действиям**: отдельная статистика для F1 и F5 действий
- **Детальные переходы**: какие переходы между уровнями происходили чаще всего
- **Завершенные сессии**: сколько раз был достигнут +10

### Формат данных

Статистика хранится в формате JSON Lines (по одному JSON объекту на строку):

```json
{"timestamp": "2026-01-13T10:30:45", "from_level": 0, "action": "F1", "result": "failed", "to_level": 0}
{"timestamp": "2026-01-13T10:30:52", "from_level": 0, "action": "F1", "result": "success", "to_level": 1}
```

Где:
- `timestamp` - время попытки
- `from_level` - уровень предмета до попытки (0-10)
- `action` - использованное действие ('F1' или 'F5')
- `result` - результат ('success' или 'failed')
- `to_level` - уровень предмета после попытки (0-10)

Этот формат легко анализировать программно или импортировать в Excel/Google Sheets для дальнейшего анализа.

## Требования

- Python 3.7+
- Tesseract OCR
- Windows/Linux

## Зависимости

- pystray - для работы с системным треем
- Pillow - для работы с изображениями
- pytesseract - для OCR
- mss - для захвата скриншотов
- keyboard - для горячих клавиш
- pyperclip - для работы с буфером обмена
